---
title: "mb5370-module-4-report"
author: "Carolina Freitas"
date: '2023-05-03'
output: html_document
---


#Workshop 4
```{r}
setwd("~/JCU/MB5370/Module 4/github/mb5370/data")
```
## QFISH

```{r}
#Importing QFish data
library (readr)
shark <- read.csv("data/sharkcontrol.csv")
```

```{r}
#Ensures every blank space is identified as a blank space

shark_clean <- as.data.frame(lapply(shark, function(x) gsub("^\\s*$", "", x)))
# ^ represents the start of line
#\\s matches any whitespace character
#* specifies that the previous symbol "\\s" can occur zero or more times. 
#$ represents the end of line

```

# Tidying the data ####
```{r}
library(dplyr)
library(tidyr)
shark_table <- setNames(shark_clean, c("Area", paste(names(shark_clean), unlist(shark_clean[1, ], use.names = FALSE), sep = "_")[-1])) %>% 
  slice(-1) %>% 
  pivot_longer(-Area) %>% 
  separate(name, into = c("Year", "SpeciesGroup"), sep = "_")
#This section reorganises the table into Area, Year, species group and value which = catches
#stringr function for year problem
```


```{r}
#Remove prefix Area. and X from columns 1 and 2
shark_table <- shark_table %>%
  mutate(Area = sub("^Area\\.", "", Area),
         Year = sub("^X", "", Year))
```

```{r}
#Rename column from value to catches
colnames(shark_table)[colnames(shark_table) == "value"] <- "Catches"
```

```{r}
#Remove all rows with totals
#install.packages("stringr")
library(stringr)
shark_table <- shark_table[!str_detect(shark_table$Year, "Total"), ]
```

```{r}
#Remove the suffix in the years. e.g. 2001.1 is replaced by 2001
shark_table$Year <- str_remove(shark_table$Year, "\\..*")
```

